<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Scala中的Map、flatMap</title><meta name="twitter:card" content="summary" /><meta name="twitter:site" content="@HeiswayiNrird" /><meta name="twitter:title" content="Scala中的Map、flatMap" /><meta name="twitter:description" content="“如果只能有一种数据结构，那就用哈希表吧。”Scala中的map和flatMap在开发中用处很多，功能也十分强大，本文将详细介绍Scala中map和flatMap的常见用法以及map和flatMap的区别。"><meta name="description" content="“如果只能有一种数据结构，那就用哈希表吧。”Scala中的map和flatMap在开发中用处很多，功能也十分强大，本文将详细介绍Scala中map和flatMap的常见用法以及map和flatMap的区别。"><link rel="icon" href="/assets/favicon.png"><link rel="apple-touch-icon" href="/assets/touch-icon.png"><style> /* latin-ext */ @font-face { font-family: 'Karla'; font-style: normal; font-weight: 400; src: local('Karla'), local('Karla-Regular'), url(https://fonts.gstatic.com/s/karla/v5/S1bXQ0LrY7AzefpgNae9sYDGDUGfDkXyfkzVDelzfFk.woff2) format('woff2'); unicode-range: U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF; } /* latin */ @font-face { font-family: 'Karla'; font-style: normal; font-weight: 400; src: local('Karla'), local('Karla-Regular'), url(https://fonts.gstatic.com/s/karla/v5/JaMH4jmmzP070-OYo03anaCWcynf_cDxXwCLxiixG1c.woff2) format('woff2'); unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215; }</style><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/notes/mapAndFlatMap"><link rel="alternate" type="application/atom+xml" title="ShawDubie" href="/feed.xml" /></head><body><aside class="logo"> <a href="/"> <img src="../assets/img/shaw.jpeg" class="gravatar"> </a> <span class="logo-prompt">Back to Home</span></aside><main> <noscript><style> article .footnotes { display: block; }</style></noscript><article><div class="center"><h1>Scala中的Map、flatMap</h1><time>March 26, 2016</time></div><div class="divider"></div><p>“如果只能有一种数据结构，那就用哈希表吧。” Scala中的map和flatMap在开发中用处很多，功能也十分强大，本文将详细介绍Scala中map和flatMap的常见用法以及map和flatMap的区别。</p><ul><li><h2 id="在某一个列表list调用map时map可以接受一个函数或者一个表达式为参数这个函数或者表达式将作用于列表中的每一个元素最终返回一个新的列表list">在某一个列表（List）调用map时，map可以接受一个函数或者一个表达式为参数，这个函数或者表达式将作用于列表中的每一个元素，最终返回一个新的列表（List）</h2></li></ul><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">,</span><span class="mi">4</span><span class="o">,</span><span class="mi">5</span><span class="o">,</span><span class="mi">6</span><span class="o">)</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">3</span><span class="o">)</span>
<span class="n">res0</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">18</span><span class="o">)</span>
</code></pre></div><p>或者</p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="n">f</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">f</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
<span class="n">res1</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">12</span><span class="o">)</span>
</code></pre></div><ul><li><h2 id="flatmap也可以传入一个函数但是这个函数的返回值类型必须是listseq或者option否则会出错">flatMap也可以传入一个函数，但是这个函数的返回值类型必须是List、Seq或者Option，否则会出错</h2></li></ul><p><em>f(x)的返回值是Int，不是List也不是Option，所以会报错</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span> <span class="n">x</span> <span class="k">=&gt;</span> <span class="n">f</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">13</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Int</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">scala.collection.GenTraversableOnce</span><span class="o">[</span><span class="kt">?</span><span class="o">]</span>
       <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span> <span class="n">x</span> <span class="k">=&gt;</span> <span class="n">f</span><span class="o">(</span><span class="n">x</span><span class="o">))</span>
                           <span class="o">^</span>
</code></pre></div><p><em>f(x)的返回值类型是Option</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="nc">Some</span><span class="o">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">1</span><span class="o">))</span>
<span class="n">res5</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">)</span>
</code></pre></div><p><em>f2(x)的返回值类型是List</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="n">f2</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span><span class="n">x</span><span class="o">,</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="o">)</span>
<span class="n">f2</span><span class="k">:</span> <span class="o">(</span><span class="kt">x:</span> <span class="kt">Int</span><span class="o">)</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f2</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
</code></pre></div><ul><li><h2 id="map和flapmap在操作返回值为list或者option时的区别">map和flapMap在操作返回值为List或者Option时的区别</h2><p><em>map方法返回的是一个列表元素为列表的列表</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list2</span> <span class="k">=</span> <span class="n">list</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">f2</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
<span class="n">list2</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">),</span> <span class="nc">List</span><span class="o">(</span><span class="mi">7</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">))</span>
</code></pre></div><p><em>flatMap方法返回的只是一个列表（List）</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">f2</span><span class="o">(</span><span class="k">_</span><span class="o">))</span>
<span class="n">res7</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
</code></pre></div><p>或者</p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list2</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span><span class="o">)</span>
<span class="n">res31</span><span class="k">:</span> <span class="kt">List</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
</code></pre></div><p>*可以看到flatMap将列表内元素的“外壳（List）”去掉了，得到的是List中的元素，这个属性在Option中很有用，我们可以将Option看作是一个List，只是其中要么只有一个元素，要么没有元素 * ```scala scala&gt; def f3(x: Int) = if(x == 0) None else Some(x) f3: (x: Int)Option[Int]</p></li></ul><p>scala&gt; val list2 = List(0,2,4,0,5,0,6,0) list2: List[Int] = List(0, 2, 4, 0, 5, 0, 6, 0)</p><p>scala&gt; list2.map(x =&gt; f3(x)) res10: List[Option[Int]] = List(None, Some(2), Some(4), None, Some(5), None, Some(6), None)</p><p>//flatMap将None过滤掉了，将类型为Option的列表元素变成了Int类型，得到一个列表元素类型为Int的列表 scala&gt; list2.flatMap(x =&gt; f3(x)) res11: List[Int] = List(2, 4, 5, 6)</p><p>//map返回的List可能含有None，而flatMap返回的列表是不可能含有None的</p><div class="highlighter-rouge"><pre class="highlight"><code>* ## map也可以操作单个数据类型为Option的值，返回的值类型也是Option，若flatMap也想操作，传入的表达式和函数的返回值类型必须是Option

```scala
scala&gt; val a = Some(1)
a: Some[Int] = Some(1)

scala&gt; a.map(_ * 2)
res12: Option[Int] = Some(2)
</code></pre></div><p><em>flatMap传入的表达式或者函数的返回值类型必须是Option，否则会出错</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="kt">Int</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">?</span><span class="o">]</span>
       <span class="n">a</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="k">_</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)</span>
                   <span class="o">^</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">a</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="nc">Some</span><span class="o">(</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="o">))</span>
<span class="n">res16</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">Int</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</code></pre></div><ul><li><h2 id="map和flatmap也可以操作列表元素为元组k---v的列表方法与上文提到的类似">map和flatMap也可以操作列表元素为元组(k -&gt; v)的列表，方法与上文提到的类似</h2></li></ul><p><em>用map将函数或者表达式应用到元组中</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list3</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">3</span><span class="o">),(</span><span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">4</span><span class="o">),(</span><span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">6</span><span class="o">),(</span><span class="mi">4</span> <span class="o">-&gt;</span> <span class="mi">8</span><span class="o">))</span>
<span class="n">list3</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">6</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">8</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list3</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span><span class="o">*</span><span class="mi">2</span><span class="o">))</span>
<span class="n">res23</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">6</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">8</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">12</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">16</span><span class="o">))</span>
</code></pre></div><p><em>用flatMap将函数或者表达式应用到元组中去的时候，返回值类型必须是List、Seq或者Option否则会出错</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="n">list3</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span><span class="o">*</span><span class="mi">2</span><span class="o">))</span>
<span class="o">&lt;</span><span class="n">console</span><span class="k">&gt;:</span><span class="mi">12</span><span class="k">:</span> <span class="kt">error:</span> <span class="k">type</span> <span class="kt">mismatch</span><span class="o">;</span>
 <span class="n">found</span>   <span class="k">:</span> <span class="o">(</span><span class="kt">Int</span><span class="o">,</span> <span class="kt">Int</span><span class="o">)</span>
 <span class="n">required</span><span class="k">:</span> <span class="kt">scala.collection.GenTraversableOnce</span><span class="o">[</span><span class="kt">?</span><span class="o">]</span>
       <span class="n">list3</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span> <span class="o">-&gt;</span> <span class="n">x</span><span class="o">.</span><span class="n">_2</span><span class="o">*</span><span class="mi">2</span><span class="o">))</span>
                                <span class="o">^</span>
</code></pre></div><p><em>函数的返回值类型是List</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">def</span> <span class="n">f4</span><span class="o">(</span><span class="n">k</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span><span class="n">v</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="n">v</span><span class="o">-</span><span class="mi">1</span><span class="o">),(</span><span class="n">k</span><span class="o">,</span><span class="n">v</span><span class="o">),(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="o">,</span><span class="n">v</span><span class="o">+</span><span class="mi">1</span><span class="o">))</span>
<span class="n">f4</span><span class="k">:</span> <span class="o">(</span><span class="kt">k:</span> <span class="kt">Int</span><span class="o">,</span> <span class="kt">v:</span> <span class="kt">Int</span><span class="o">)</span><span class="nc">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list3</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="n">f4</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span><span class="o">,</span><span class="n">x</span><span class="o">.</span><span class="n">_2</span><span class="o">))</span>
<span class="n">res25</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">5</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">6</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">7</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">7</span><span class="o">),</span> <span class="o">(</span><span class="mi">4</span><span class="o">,</span><span class="mi">8</span><span class="o">),</span> <span class="o">(</span><span class="mi">5</span><span class="o">,</span><span class="mi">9</span><span class="o">))</span>
</code></pre></div><p><em>表达式的返回值类型是Option</em></p><div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">scala</span><span class="o">&gt;</span> <span class="k">val</span> <span class="n">list4</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">1</span><span class="o">),(</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">2</span><span class="o">),(</span><span class="mi">0</span> <span class="o">-&gt;</span> <span class="mi">3</span><span class="o">),(</span><span class="mi">1</span> <span class="o">-&gt;</span> <span class="mi">4</span><span class="o">),(</span><span class="mi">2</span> <span class="o">-&gt;</span> <span class="mi">5</span><span class="o">),(</span><span class="mi">3</span> <span class="o">-&gt;</span> <span class="mi">6</span><span class="o">))</span>
<span class="n">list4</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="mi">3</span><span class="o">),</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">5</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">6</span><span class="o">))</span>

<span class="n">scala</span><span class="o">&gt;</span> <span class="n">list4</span><span class="o">.</span><span class="n">flatMap</span><span class="o">(</span><span class="n">x</span> <span class="k">=&gt;</span> <span class="k">if</span><span class="o">(</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="nc">None</span> <span class="k">else</span> <span class="nc">Some</span><span class="o">((</span><span class="n">x</span><span class="o">.</span><span class="n">_1</span><span class="o">,</span><span class="n">x</span><span class="o">.</span><span class="n">_2</span> <span class="o">*</span> <span class="mi">2</span><span class="o">)))</span>
<span class="n">res26</span><span class="k">:</span> <span class="kt">List</span><span class="o">[(</span><span class="kt">Int</span>, <span class="kt">Int</span><span class="o">)]</span> <span class="k">=</span> <span class="nc">List</span><span class="o">((</span><span class="mi">1</span><span class="o">,</span><span class="mi">8</span><span class="o">),</span> <span class="o">(</span><span class="mi">2</span><span class="o">,</span><span class="mi">10</span><span class="o">),</span> <span class="o">(</span><span class="mi">3</span><span class="o">,</span><span class="mi">12</span><span class="o">))</span>
</code></pre></div></article><div class="page-navigation"> <a class="next" href="/notes/%E5%A6%82%E4%BD%95%E7%A7%91%E5%AD%A6%E5%9C%B0%E6%93%8D%E4%BD%9CScala%E4%B8%AD%E7%9A%84%E9%9B%86%E5%90%88" title="NEXT: 如何科学地操作scala中的集合">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="/" title="Back to Homepage">Home</a></div></main><div class="footer"> <span class="block">Made with &hearts; using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> &amp; <a href="https://github.com/heiswayi/the-plain" title="The Plain theme by Heiswayi Nrird" target="_blank">The Plain</a> &middot; &lt;/&gt; on <a href="https://github.com/Shonrain" title="Hosted on GitHub" target="_blank">GitHub</a></span> <span class="block">&copy; 2017 ShawDubie</span></div></body></html>