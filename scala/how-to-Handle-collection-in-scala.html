<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <title>ShawDubie</title><meta name="description" content="Shaw`s blog">
    <link rel="preload" href="/assets/style-CkTGTLwf.css" as="style"><link rel="stylesheet" href="/assets/style-CkTGTLwf.css">
    <link rel="modulepreload" href="/assets/app-B2I_ZL3S.js"><link rel="modulepreload" href="/assets/how-to-Handle-collection-in-scala.html-C9EyZhbM.js">
    <link rel="prefetch" href="/assets/get-started.html-M-lWy3HG.js" as="script"><link rel="prefetch" href="/assets/index.html-BOImT6yy.js" as="script"><link rel="prefetch" href="/assets/day-night-button.html-YWYH8cyG.js" as="script"><link rel="prefetch" href="/assets/know-react.html-DZAOKFeN.js" as="script"><link rel="prefetch" href="/assets/know-redux.html-_bd4v4rc.js" as="script"><link rel="prefetch" href="/assets/reactive-web-application-4.html-DcPSnQ79.js" as="script"><link rel="prefetch" href="/assets/reactive-web-application-5.html-DsVW_Pab.js" as="script"><link rel="prefetch" href="/assets/reactive-web-applications-1.html-Dn7y9sda.js" as="script"><link rel="prefetch" href="/assets/reactive-web-applications-2.html-BR3F-YLX.js" as="script"><link rel="prefetch" href="/assets/reactive-web-applications-3.html-Dt8PJxWv.js" as="script"><link rel="prefetch" href="/assets/how-to-use-algebraic-data-type-in-development.html-D_e_Yzwj.js" as="script"><link rel="prefetch" href="/assets/mapAndFlatMap.html-DcpQSV0D.js" as="script"><link rel="prefetch" href="/assets/performance-in-collection.html-DHKcKDhG.js" as="script"><link rel="prefetch" href="/assets/compile-in-vue-share.html-CZrTGo2j.js" as="script"><link rel="prefetch" href="/assets/compile-in-vue-share2.html-CcsBknBJ.js" as="script"><link rel="prefetch" href="/assets/reactive-in-vue.html-y7hyDwXJ.js" as="script"><link rel="prefetch" href="/assets/share-technology-stack.html-VyA6D5Dl.js" as="script"><link rel="prefetch" href="/assets/architecture-of-play.html-CW0BAYCc.js" as="script"><link rel="prefetch" href="/assets/dependency-injection.html-D02c3P4E.js" as="script"><link rel="prefetch" href="/assets/dependency-injection2.html-BikoafvB.js" as="script"><link rel="prefetch" href="/assets/first-glance-at-play.html-CHvoP8ld.js" as="script"><link rel="prefetch" href="/assets/compile-in-vue.html-DJsVqPVW.js" as="script"><link rel="prefetch" href="/assets/diff-in-vue.html-DK8fKepY.js" as="script"><link rel="prefetch" href="/assets/garbage-collection.html-Zc3PCtVM.js" as="script"><link rel="prefetch" href="/assets/glance-renderer.html-BZas9JsR.js" as="script"><link rel="prefetch" href="/assets/glance-v8.html-Ck54VgnX.js" as="script"><link rel="prefetch" href="/assets/glance-vue.html-CCcVYyIa.js" as="script"><link rel="prefetch" href="/assets/optimize-reactive.html-B8WynxS5.js" as="script"><link rel="prefetch" href="/assets/reactive-array.html-DjqUEJuq.js" as="script"><link rel="prefetch" href="/assets/reactive-collection.html-Dn_xHgeE.js" as="script"><link rel="prefetch" href="/assets/reactive-in-vue.html-DwNRS1mS.js" as="script"><link rel="prefetch" href="/assets/reactive-scheduler.html-CbdSyiCe.js" as="script"><link rel="prefetch" href="/assets/ref-in-vue.html-NnnH-E9p.js" as="script"><link rel="prefetch" href="/assets/404.html-Fj9Pq08g.js" as="script"><link rel="prefetch" href="/assets/Banner-C1J18Y0w.js" as="script"><link rel="prefetch" href="/assets/CompilerDemo-CxVHwSQ0.js" as="script"><link rel="prefetch" href="/assets/DayNightButton-dWfKlfF6.js" as="script"><link rel="prefetch" href="/assets/OnlyStar-BVNaj8uW.js" as="script"><link rel="prefetch" href="/assets/ParseProgress-CinFq9wL.js" as="script"><link rel="prefetch" href="/assets/ReactiveDemo-B9qGxLds.js" as="script"><link rel="prefetch" href="/assets/Star-i-m4XstO.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-B9UE0pwM.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">ShawDubie</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><!----><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading"> <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h2 class="blog-title">如何在 Scala 中科学地操作 collection（一）：集合类型与操作</h2><p>在日常项目开发中，我们几乎都会用到Scala中的集合以及一些集合操作。由于 Scala 中的集合操作灵活多变，对于刚接触Scala的开发者，在选用何种集合以及使用何种集合操作就显得不那么合理了，虽然大部分时候都可以解决问题，但是有时候并没有选择最优的方式。科学合理地操作Scala中的集合可以使我们的代码变得更加简洁和高效。</p><h2 id="mutable-和-immutable-集合" tabindex="-1"><a class="header-anchor" href="#mutable-和-immutable-集合"><span>Mutable 和 Immutable 集合</span></a></h2><p>Scala 集合类系统地区分了可变的和不可变的集合。</p><h3 id="scala-collection-包中所有的集合类" tabindex="-1"><a class="header-anchor" href="#scala-collection-包中所有的集合类"><span>scala.collection 包中所有的集合类</span></a></h3><p><img src="/assets/collections-VxBlpPfX.png" alt="Image of collections"></p><h3 id="scala-collection-mutable-中的所有集合类" tabindex="-1"><a class="header-anchor" href="#scala-collection-mutable-中的所有集合类"><span>scala.collection.mutable 中的所有集合类</span></a></h3><p><code>可变集合</code>，顾名思义，意味着你可以修改，移除或者添加一个元素。</p><p><img src="/assets/collections.mutable-23nKGhf2.png" alt="Image of immutatble collection"></p><h3 id="scala-collection-immutable-中的所有集合类" tabindex="-1"><a class="header-anchor" href="#scala-collection-immutable-中的所有集合类"><span>scala.collection.immutable 中的所有集合类</span></a></h3><p><code>不可变集合</code>，相比<code>可变集合</code>，<code>不可变集合</code>永远不会被改变，但是你仍然可以像<code>可变集合</code>那样操作（修改，添加，删除某个集合元素）<code>不可变集合</code>，只是这些操作在每一种情况下都是返回一个新的集合，同时，原来的集合不会发生改变，由于此特性，<code>不可变集合</code>也是线程安全的，Scala在默认情况下采用的是<code>不可变集合</code>。所以在使用上，优先使用<code>不可变集合</code>。<code>不可变集</code>合适用于大多数情况。</p><p><img src="/assets/collections.immutable-BaWzKyp9.png" alt="Image of mutable collection"></p><h2 id="不同集合的使用场景" tabindex="-1"><a class="header-anchor" href="#不同集合的使用场景"><span>不同集合的使用场景</span></a></h2><p>其中常用的集合有三种：<code>List</code>，<code>Set</code>，<code>Map</code>。</p><h3 id="列表-list" tabindex="-1"><a class="header-anchor" href="#列表-list"><span>列表 List</span></a></h3><p><code>List</code> 继承至 <code>Seq</code>，集合中的元素是可以重复的。</p><p>e.g.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> l <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">l<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>所以当集合内的元素是可重复的时候，可以选择 <code>List</code> 或者 <code>Seq</code>。</p><h3 id="集-set" tabindex="-1"><a class="header-anchor" href="#集-set"><span>集 Set</span></a></h3><p><code>Set</code> 中的元素是不可重复的。</p><p>e.g.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> s <span class="token operator">=</span> Set<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">s<span class="token operator">:</span> scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>immutable<span class="token punctuation">.</span>Set<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> Set<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>所以当集合内的元素是不可重复的时候，选择 <code>Set</code>。</p><h3 id="映射-map" tabindex="-1"><a class="header-anchor" href="#映射-map"><span>映射 Map</span></a></h3><p><code>Map</code> 中的元素呈现 <code>key -&gt; value</code> 的形式，其中第一个参数是映射的键，第二个参数是映射的值。且Map中每一个元素的键是唯一的。</p><p>e.g.</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> m <span class="token operator">=</span> Map<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">-&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">-&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">-&gt;</span> <span class="token number">7</span><span class="token punctuation">)</span></span>
<span class="line">m<span class="token operator">:</span> scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>immutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">,</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> Map<span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">-&gt;</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">-&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">-&gt;</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token operator">-&gt;</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token operator">-&gt;</span> <span class="token number">4</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>所以当集合中的元素是 <code>key -&gt; value</code> 的形式且每个元素的键不重复的时候，选择 <code>Map</code>。</p><h2 id="集合中方法的使用" tabindex="-1"><a class="header-anchor" href="#集合中方法的使用"><span>集合中方法的使用</span></a></h2><h3 id="各集合操作之间的比较" tabindex="-1"><a class="header-anchor" href="#各集合操作之间的比较"><span>各集合操作之间的比较</span></a></h3><p>在开始介绍不同方法的使用场景之前，我们先对比一下不同方法操作同一集合所产出的结果有何异同。</p><ul><li><code>map</code>、<code>filter</code>、<code>collect</code> 的比较</li></ul><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token comment">//定义一个列表</span></span>
<span class="line">scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> l <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line">l<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//map操作</span></span>
<span class="line">scala<span class="token operator">&gt;</span> l<span class="token punctuation">.</span>map<span class="token punctuation">(</span>_ <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">res0<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//filter操作</span></span>
<span class="line">scala<span class="token operator">&gt;</span> l<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_ <span class="token operator">&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">res3<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//collect操作</span></span>
<span class="line">scala<span class="token operator">&gt;</span> l<span class="token punctuation">.</span>collect <span class="token punctuation">{</span><span class="token keyword">case</span> i <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">2</span> <span class="token keyword">=&gt;</span> i <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">}</span></span>
<span class="line">res1<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过以上结果对比我们可以看到：</p><p><code>map</code> 操作得到的集合，除了元素个数和原集合一样，其他都不一样。</p><p><code>filter</code> 操作得到的集合是原集合的子集。</p><p><code>collect</code> 操作得到的集合虽然和原集合不一样，但是仔细观察，可以看到 <code>collect</code> 操作得到的结果是 <code>map</code> 操作得到结果的子集，而且元素的个数和 <code>filter</code> 操作得到的集合元素个数相同。</p><ul><li><code>flatten</code> 和 <code>flatMap</code> 的比较</li></ul><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token comment">//定义一个列表</span></span>
<span class="line">scala<span class="token operator">&gt;</span> <span class="token keyword">val</span> l <span class="token operator">=</span> List<span class="token punctuation">(</span>List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> List<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Seq<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">l<span class="token operator">:</span> List<span class="token punctuation">[</span>Seq<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> List<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> List<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//flatten操作</span></span>
<span class="line">scala<span class="token operator">&gt;</span> l<span class="token punctuation">.</span>flatten</span>
<span class="line">res5<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">//flatMap操作</span></span>
<span class="line">scala<span class="token operator">&gt;</span> l<span class="token punctuation">.</span>flatMap<span class="token punctuation">(</span>i <span class="token keyword">=&gt;</span> i<span class="token punctuation">.</span>map<span class="token punctuation">(</span>_ <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">res6<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过以上结果我们可以看到，<code>flatten</code> 和 <code>flatMap</code> 都可可以将嵌套结构扁平化为一个层次的集合，但是：</p><p><code>flatten</code> 仅仅是将嵌套结构扁平化了，并没有改变原来集合内层列表中元素的值。</p><p><code>flatMap</code> 不仅将嵌套结构扁平化了，而且改变了原来集合内层列表中元素的值，其实 <code>flatMap</code> 就是在 <code>flatten</code> 之后再做一个 <code>map</code> 操作。</p><p>补充：以上操作返回的都是一个批量的结果，如果要查找某一特定元素，则可以采用类比的方法：</p><p><code>filter</code> -&gt; <code>find</code></p><p><code>collect</code> -&gt; <code>collectFirst</code></p><h3 id="不同方法的使用场景" tabindex="-1"><a class="header-anchor" href="#不同方法的使用场景"><span>不同方法的使用场景</span></a></h3><p>通过以上对比，我们对集合中常用方法的操作结果有了一个大致的认识，接下来我们看看在不同场景下如何科学地选择相应的集合操作。</p><p>我们先定义一些将要在后面场景中使用的数据结构：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">case</span> <span class="token keyword">class</span> Student<span class="token punctuation">(</span></span>
<span class="line">  name<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span></span>
<span class="line">  age<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">,</span></span>
<span class="line">  sex<span class="token operator">:</span> <span class="token builtin">String</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> jilen <span class="token operator">=</span> Student<span class="token punctuation">(</span></span>
<span class="line">  name <span class="token operator">=</span> <span class="token string">&quot;Jilen&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span></span>
<span class="line">  sex <span class="token operator">=</span> <span class="token string">&quot;m&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> shaw <span class="token operator">=</span> Student<span class="token punctuation">(</span></span>
<span class="line">  name <span class="token operator">=</span> <span class="token string">&quot;Shaw&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">,</span></span>
<span class="line">  sex <span class="token operator">=</span> <span class="token string">&quot;m&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> yison <span class="token operator">=</span> Student<span class="token punctuation">(</span></span>
<span class="line">  name <span class="token operator">=</span> <span class="token string">&quot;Yison&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  age <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">,</span></span>
<span class="line">  sex <span class="token operator">=</span> <span class="token string">&quot;f&quot;</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">val</span> l <span class="token operator">=</span> List<span class="token punctuation">(</span>jilen<span class="token punctuation">,</span> shaw<span class="token punctuation">,</span> yison<span class="token punctuation">)</span></span>
<span class="line">l<span class="token operator">:</span> List<span class="token punctuation">[</span>Student<span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Yison<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如上，我们定义了一个学生组成的列表。</p><h4 id="场景一-我们要得到这些学生姓名所组成的列表" tabindex="-1"><a class="header-anchor" href="#场景一-我们要得到这些学生姓名所组成的列表"><span>场景一：我们要得到这些学生姓名所组成的列表</span></a></h4><p>分析：学生姓名所组成的列表和原列表（学生列表）是不同的，是一个全新的列表，所以这里选用 <code>map</code></p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> nameList <span class="token operator">=</span> l<span class="token punctuation">.</span>map<span class="token punctuation">(</span>_<span class="token punctuation">.</span>name<span class="token punctuation">)</span></span>
<span class="line">nameList<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span> Shaw<span class="token punctuation">,</span> Yison<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>map</code> 是对集合中的每个元素应用一个函数，返回应用后的元素所组成的集合，通常情况下，map所返回的集合和原集合是是不同类型的集合，也就是一个全新的集合。</p><h4 id="场景二-我们要得到所有性别是男-m-的学生所组成的列表" tabindex="-1"><a class="header-anchor" href="#场景二-我们要得到所有性别是男-m-的学生所组成的列表"><span>场景二：我们要得到所有性别是男（m）的学生所组成的列表</span></a></h4><p>分析：得到的列表还是学生列表，并且该列表是原列表的子集，因为有一个附加条件：男性学生，所以这里选用 <code>filter</code></p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> maleList <span class="token operator">=</span> l<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span></span>
<span class="line">maleList<span class="token operator">:</span> List<span class="token punctuation">[</span>Student<span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>filter</code> 一般用于移除集合中不满足条件的元素，返回满足条件的元素所组成的集合。 当然，这里用 <code>collect</code> 也可以解决问题：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> maleList <span class="token operator">=</span> l<span class="token punctuation">.</span>collect<span class="token punctuation">{</span><span class="token keyword">case</span> s <span class="token keyword">if</span> s<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">&quot;m&quot;</span> <span class="token keyword">=&gt;</span> s<span class="token punctuation">}</span></span>
<span class="line">maleList<span class="token operator">:</span> List<span class="token punctuation">[</span>Student<span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>但是对比一下，可以发现filter更加简洁。</p><h4 id="场景三-我们要得到男学生姓名所组成的列表" tabindex="-1"><a class="header-anchor" href="#场景三-我们要得到男学生姓名所组成的列表"><span>场景三： 我们要得到男学生姓名所组成的列表</span></a></h4><p>分析：要得到男学生姓名，我们首先要得到男学生，然后再去获取这些学生的姓名，所以我们很容易采用：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> maleNameList <span class="token operator">=</span> l<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>_<span class="token punctuation">.</span>name<span class="token punctuation">)</span></span>
<span class="line">maleNameList<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span> Shaw<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>但是通过我们在之前<code>各集合操作之间的比较</code>中所得出的结论，由于男学生姓名列表是一个和原列表（学生列表）完全不同的，并且该列表是学生姓名列表的子集，所以我们可以采用 <code>collect</code>：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> maleNameList <span class="token operator">=</span> l<span class="token punctuation">.</span>collect<span class="token punctuation">{</span><span class="token keyword">case</span> s <span class="token keyword">if</span> s<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">&quot;m&quot;</span> <span class="token keyword">=&gt;</span> s<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>
<span class="line">maleNameList<span class="token operator">:</span> List<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span> Shaw<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>得到的结果和上面操作的结果一样。</p><p><code>collect</code> 接受的是一个偏函数，对集合中每个元素应用该函数，返回应用后的元素所组成的列表，可以将 <code>collect</code> 看作是先做 <code>filter</code> 操作再做 <code>map</code> 操作：</p><p>场景二中的 <code>collect</code> 操作可以看作是：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">l<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>sex <span class="token operator">==</span> <span class="token string">&quot;m&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>s <span class="token keyword">=&gt;</span> s<span class="token punctuation">)</span></span>
<span class="line">List<span class="token punctuation">[</span>Student<span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="其他常用方法" tabindex="-1"><a class="header-anchor" href="#其他常用方法"><span>其他常用方法</span></a></h3><h4 id="场景四-现在我们要得到每个学生在列表中的位置以方便给他们编号" tabindex="-1"><a class="header-anchor" href="#场景四-现在我们要得到每个学生在列表中的位置以方便给他们编号"><span>场景四：现在我们要得到每个学生在列表中的位置以方便给他们编号</span></a></h4><p>分析：我们可以采用 <code>学生 -&gt; 编号</code> 的形式来组织学生与编号之前的关系，这里我们可以采用 <code>zipWithIndex</code>：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line">l<span class="token punctuation">.</span>zipWithIndex</span>
<span class="line">List<span class="token punctuation">[</span><span class="token punctuation">(</span>Student<span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> List<span class="token punctuation">(</span><span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Yison<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>zipWithIndex</code> 将可以将集合内的元素与该元素在集合中的位置组合在一起，其实就是将集合内的元素与该元素的位置组成了一个元组，元组的第二个值是元素在集合中所处的位置。</p><h4 id="场景五-现在要将男学生和女学生分组-男学生组成一个集合-女学生组成一个集合" tabindex="-1"><a class="header-anchor" href="#场景五-现在要将男学生和女学生分组-男学生组成一个集合-女学生组成一个集合"><span>场景五：现在要将男学生和女学生分组，男学生组成一个集合，女学生组成一个集合</span></a></h4><p>分析：根据场景的描述，新集合内的元素应该是：<code>sex -&gt; List[Student]</code>的形式，这里我们可以采用：<code>groupBy</code>：</p><div class="language-scala line-numbers-mode" data-highlighter="prismjs" data-ext="scala" data-title="scala"><pre><code><span class="line"><span class="token keyword">val</span> group <span class="token operator">=</span> l<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span>_<span class="token punctuation">.</span>sex<span class="token punctuation">)</span></span>
<span class="line">group<span class="token operator">:</span> scala<span class="token punctuation">.</span>collection<span class="token punctuation">.</span>immutable<span class="token punctuation">.</span>Map<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">,</span>List<span class="token punctuation">[</span>Student<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> Map<span class="token punctuation">(</span>m <span class="token operator">-&gt;</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Jilen<span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> Student<span class="token punctuation">(</span>Shaw<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> f <span class="token operator">-&gt;</span> List<span class="token punctuation">(</span>Student<span class="token punctuation">(</span>Yison<span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>groupBy</code> 就是对集合按照特定的要求进行分组，返回一个 <code>Map</code>类型。</p><h2 id="延伸阅读" tabindex="-1"><a class="header-anchor" href="#延伸阅读"><span>延伸阅读</span></a></h2><p><a href="https://pavelfatin.com/scala-collections-tips-and-tricks/" target="_blank" rel="noopener noreferrer">Scala Collections Tips and Tricks</a></p><p><a href="https://twitter.github.io/scala_school/zh_cn/collections.html" target="_blank" rel="noopener noreferrer">集合</a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-B2I_ZL3S.js" defer></script>
  </body>
</html>
